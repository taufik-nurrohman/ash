
<!DOCTYPE html>
<html dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta content="width=device-width" name="viewport">
    <title>Asynchronous Syntax Highlighter</title>
    <link href="ash.css" rel="stylesheet">
    <style>

* {
  box-sizing: border-box;
}

textarea {
  display: block;
  width: 100%;
  height: 15em;
}

label {
  display: inline-block;
  cursor: pointer;
}

.inspect code span {
  outline: 1px dotted;
}

.inspect code span::after {
  content: '(' attr(class) ')';
  display: inline-block;
  vertical-align: middle;
  font-size: 75%;
}

    </style>
  </head>
  <body>
    <form>
      <p>
        <select name="x">
          <option disabled selected>Syntax&hellip;</option>
          <option value="">Generic Pattern Test</option>
          <option value="css">CSS</option>
          <option value="html">HTML</option>
          <option value="ini">INI</option>
          <option value="js">JavaScript</option>
          <option value="json">JSON</option>
          <option value="php">PHP</option>
          <option value="sgml">SGML, SVG, XML</option>
          <option value="txt">Plain Text</option>
          <option value="yaml">YAML</option>
        </select>
      </p>
      <p>
        <textarea name="content"></textarea>
      </p>
      <p>
        <button name="submit" type="submit">Update</button>
      </p>
    </form>
    <hr>
    <pre></pre>
    <p>
      <label>
        <input type="checkbox">
        <span>Inspect</span>
      </label>
    </p>
    <script src="ash.js"></script>
    <script>

(function(win, doc) {

    let form = doc.forms[0],
        content = form.content,
        toggle = doc.querySelector('input[type=checkbox]'),
        root = doc.documentElement,
        view = doc.querySelector('pre'),
        x = form.x;

    form.addEventListener('submit', e => {
        let code = doc.createElement('code');
        code.className = x.value;
        code.textContent = content.value;
        view.innerHTML = "";
        view.appendChild((new ASH(code)).source);
        e.preventDefault();
    });

    // Load example by select-box change
    x.addEventListener('change', () => {
        win.fetch('test/' + x.value + '.txt').then(response => response.ok && response.text()).then(text => {
            content.value = text;
            form.submit.click();
        }).catch(e => {
            content.value = e;
        });
    });

    // Toggle inspector
    toggle.addEventListener('change', () => {
        root.classList[toggle.checked ? 'add' : 'remove']('inspect');
    });

})(window, document);

    </script>
  </body>
</html>
